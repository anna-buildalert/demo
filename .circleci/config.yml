version: 2.1

# set project level environment variables

orbs:
  buildalert: buildalert/demo@dev:0.0.2

# jobs:
#   probe:
#     docker:
#       - image: circleci/node:9.6.1
#     steps:
#       - run: echo 'am i running'

workflows:
  monitor-every-minute:
    triggers:
      - schedule:
          cron: "* * * * *"
          filters:
            branches:
              only:
                - master
    jobs:
      # - probe
      - buildalert/build:
          alert-threshold-seconds: 50000
          alert-threshold-max-builds-per-user: 0
          alert-threshold-max-builds-prev-minute: 0    
          circle-project-username-envvar: SLACK_MONITOR_CIRCLE_PROJECT_USERNAME
          circle-project-reponame-envvar: SLACK_MONITOR_CIRCLE_PROJECT_REPONAME
          circle-token-envvar: SLACK_MONITOR_CIRCLE_TOKEN
          slack-app-url-envvar: SLACK_MONITOR_SLACK_APP_URL
